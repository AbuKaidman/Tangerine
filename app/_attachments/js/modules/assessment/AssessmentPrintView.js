// Generated by CoffeeScript 1.4.0
var AssessmentPrintView,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

AssessmentPrintView = (function(_super) {

  __extends(AssessmentPrintView, _super);

  function AssessmentPrintView() {
    return AssessmentPrintView.__super__.constructor.apply(this, arguments);
  }

  AssessmentPrintView.prototype.className = "AssessmentPrintView";

  AssessmentPrintView.prototype.initialize = function(options) {
    var _this = this;
    this.abortAssessment = false;
    this.index = 0;
    this.model = options.model;
    this.format = options.format;
    Tangerine.activity = "assessment print";
    this.subtestViews = [];
    this.model.subtests.sort();
    return this.model.subtests.each(function(subtest) {
      var subtestView;
      subtestView = new SubtestPrintView({
        model: subtest,
        parent: _this,
        format: _this.format
      });
      subtestView.on("rendered", function(view) {
        return view != null ? typeof view.afterRender === "function" ? view.afterRender() : void 0 : void 0;
      });
      return _this.subtestViews.push(subtestView);
    });
  };

  AssessmentPrintView.prototype.render = function() {
    var _this = this;
    if (this.model.subtests.length === 0) {
      this.$el.append("<h1>Oops...</h1><p>This assessment is blank. Perhaps you meant to add some subtests.</p>");
    } else {
      this.$el.addClass("format-" + this.format).append("        <div class='print-page " + this.format + "'>          <h2>" + (this.model.get("name").titleize()) + "</h2>          <h3>            " + (this.model.get("updated") ? "Last Updated: " + (moment(this.model.get("updated"))) : "") + "          </h3>          <table class='marking-table'>            <tr>              <td style='vertical-align:middle'>Enumerator Name</td><td class='marking-area'></td>            </tr>          </table>        </div>        <hr/>        <style>          body{            font-size: 100%;          }          #prototype_wrapper .print-page{            size: 11in 8.5in;             height: 11in;            width: 8.5in;            margin: 0;            page-break-after: always;            overflow: hidden;            @bottom-right {              content: counter(page) \" of \" counter(pages);            }          }          #prototype_wrapper .print-page.backup{            page-break-before: always;            overflow: visible;            height:auto;          }          #prototype_wrapper .print-page table{            table-layout: fixed;          }          .format-stimuli table td{            overflow: hidden;            text-align: center;            padding: 1%;            font-family: Andika;          }          .format-stimuli{            font-family: Andika;          }          .print-question-option{            display:block;          }          table.marking-table{            border-collapse: separate;            border-spacing:10px;          }          td.marking-area, .free-text{            margin: 10px;            width: 4in;            height: 1in;            border: solid 1px;          }          .subtest-title{            font-style:italic;            padding-bottom:20px;            color:gray;          }          .survey-questions .stimuli-question{            padding-bottom: 3%;          }          .free-text{            margin-left:0px;            margin-top:0px;            margin-bottom:0px;          }          .print-question-option{            text-indent:20px;            margin-right:10px;          }          .backup-question{            border: solid 1px;            margin-top: 10px;            page-break-inside: avoid;          }          .checkbox{            border: solid 1px;            height: .25in;            width: .25in;          }          .print-question-label{            vertical-align: middle;          }          .student-dialog{            background-color: #EEEEEE;          }          .format-backup .item{            font-size:150%;            border: solid 1px;            padding: 5px;          }        </style>      ");
      _.each(this.subtestViews, function(subtestView) {
        subtestView.render();
        return _this.$el.append(subtestView.el);
      });
    }
    _.delay(function() {
      alert("Hiding header and footers, press browser back button if you need to return");
      $('#navigation').hide();
      $('#footer').hide();
      return print();
    }, 1000);
    return this.trigger("rendered");
  };

  return AssessmentPrintView;

})(Backbone.View);
