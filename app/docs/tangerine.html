<!DOCTYPE html>  <html> <head>   <title>tangerine.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               tangerine.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>One view to rule them all
Not necessary to be a view but just in case we need it to do more</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">ViewManager</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>
  <span class="nv">show: </span><span class="nf">(view) -&gt;</span>
    <span class="nx">@currentView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
    <span class="vi">@currentView = </span><span class="nx">view</span>
    <span class="nx">@currentView</span><span class="p">.</span><span class="kc">on</span> <span class="s">&quot;rendered&quot;</span><span class="p">,</span> <span class="o">=&gt;</span> 
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">@currentView</span><span class="p">.</span><span class="nx">el</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>one for the money</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">@currentView</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;rendered&quot;</span>


<span class="nv">vm = </span><span class="k">new</span> <span class="nx">ViewManager</span>

<span class="k">class</span> <span class="nx">AssessmentElement</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>

  <span class="nv">tagName : </span><span class="s">&quot;li&quot;</span>

  <span class="nv">events:</span>
    <span class="s">&#39;click .link_icon&#39;</span> <span class="o">:</span> <span class="s">&#39;navigate&#39;</span>
    <span class="s">&#39;click .assessment_menu_toggle&#39;</span> <span class="o">:</span> <span class="s">&#39;assessmentMenuToggle&#39;</span>

  <span class="nx">initialize</span><span class="o">:</span><span class="nf">(options) -&gt;</span>
    <span class="vi">@isAdmin = </span><span class="nx">options</span><span class="p">.</span><span class="nx">isAdmin</span>
    <span class="vi">@model = </span><span class="nx">options</span><span class="p">.</span><span class="nx">model</span>

  <span class="nv">navigate: </span><span class="nf">(event) -&gt;</span>
    <span class="nv">whereTo = </span><span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&#39;data-href&#39;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span> <span class="nx">whereTo</span><span class="p">,</span> <span class="kc">true</span>

  <span class="nv">assessmentMenuToggle: </span><span class="o">-&gt;</span>
    <span class="nv">toggleChar = </span><span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span> <span class="s">&#39;.assessment_menu_toggle&#39;</span>
    <span class="k">if</span> <span class="nx">toggleChar</span><span class="p">.</span><span class="nx">html</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;&amp;gt; &#39;</span> <span class="k">then</span> <span class="nx">toggleChar</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&amp;nabla; &#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nx">toggleChar</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s">&quot;&amp;gt; &quot;</span><span class="p">)</span> 
    <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.assessment_menu&#39;</span><span class="p">).</span><span class="nx">toggle</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>

  <span class="nv">render: </span><span class="o">-&gt;</span>
    <span class="nv">deleteButton  = </span><span class="s">&quot;&lt;img data-href=&#39;delete&#39; class=&#39;link_icon&#39; src=&#39;images/icon_delete.png&#39;&gt;&quot;</span>
    <span class="nv">editButton    = </span><span class="s">&quot;&lt;img data-href=&#39;edit/&#39; class=&#39;link_icon&#39; src=&#39;images/icon_edit.png&#39;&gt;&quot;</span>
    <span class="nv">resultsButton = </span><span class="s">&quot;&lt;img data-href=&#39;results&#39; class=&#39;link_icon&#39; src=&#39;images/icon_result.png&#39;&gt;&quot;</span>
    <span class="nv">runButton     = </span><span class="s">&quot;&lt;img data-href=&#39;run&#39; class=&#39;link_icon&#39; src=&#39;images/icon_run.png&#39;&gt;&quot;</span>
    <span class="nv">name          = </span><span class="s">&quot;&lt;span class=&#39;name&#39;&gt;</span><span class="si">#{</span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span><span class="si">}</span><span class="s">&lt;/span&gt;&quot;</span>
    <span class="nv">resultCount   = </span><span class="s">&quot;&lt;span class=&#39;resultCount&#39;&gt;</span><span class="si">#{</span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;resultCount&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="s">&#39;0&#39;</span><span class="si">}</span><span class="s"> results&lt;/span&gt;&quot;</span>
    <span class="nv">subtestCount  = </span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;urlPathsForPages&#39;</span><span class="p">).</span><span class="nx">length</span>

    <span class="k">if</span> <span class="nx">@isAdmin</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">html</span> <span class="s">&quot;</span>
<span class="s">        &lt;div&gt;</span>
<span class="s">          &lt;span class=&#39;assessment_menu_toggle clickable&#39;&gt;&amp;gt; &lt;/span&gt;</span>
<span class="s">            </span><span class="si">#{</span><span class="nx">name</span><span class="si">}</span><span class="s"> </span>
<span class="s">            </span><span class="si">#{</span><span class="nx">resultCount</span><span class="si">}</span><span class="s"></span>
<span class="s">        &lt;/div&gt;</span>
<span class="s">        &lt;div class=&#39;assessment_menu&#39;&gt;</span>
<span class="s">          </span><span class="si">#{</span><span class="nx">runButton</span><span class="si">}</span><span class="s"></span>
<span class="s">          </span><span class="si">#{</span><span class="nx">resultsButton</span><span class="si">}</span><span class="s"></span>
<span class="s">          </span><span class="si">#{</span><span class="nx">editButton</span><span class="si">}</span><span class="s"></span>
<span class="s">          </span><span class="si">#{</span><span class="nx">deleteButton</span><span class="si">}</span><span class="s"></span>
<span class="s">        &lt;/div&gt;&quot;</span>
    <span class="k">else</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">html</span> <span class="s">&quot;&lt;div&gt;</span><span class="si">#{</span><span class="nx">runButton</span><span class="si">}#{</span><span class="nx">name</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">resultsButton</span><span class="si">}#{</span><span class="nx">resultCount</span><span class="si">}</span><span class="s">&lt;/div&gt;&quot;</span>


<span class="k">class</span> <span class="nx">AssessmentList</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>

  <span class="nv">tagName   : </span><span class="s">&quot;ul&quot;</span>

  <span class="nv">className : </span><span class="s">&quot;assessmentList&quot;</span>

  <span class="nv">events:</span>
    <span class="s">&#39;submit form&#39;</span>                  <span class="o">:</span> <span class="s">&#39;newAssessmentSave&#39;</span>
    <span class="s">&#39;click .new_assessment_save&#39;</span>   <span class="o">:</span> <span class="s">&#39;newAssessmentSave&#39;</span>
    <span class="s">&#39;click .new_assessment_cancel&#39;</span> <span class="o">:</span> <span class="s">&#39;newAssessmentHide&#39;</span>
    <span class="s">&#39;click .add_assessment&#39;</span>        <span class="o">:</span> <span class="s">&#39;newAssessmentShow&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Making a new assessment</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">newAssessmentShow: </span> <span class="o">-&gt;</span> <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.new_assessment_form&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>
  <span class="nv">newAssessmentHide: </span> <span class="o">-&gt;</span> <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.new_assessment_form&#39;</span><span class="p">).</span><span class="nx">fadeOut</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>
  <span class="nv">newAssessmentValid: </span><span class="o">-&gt;</span> <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.new_assessment_name&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span>
  <span class="nv">newAssessmentSave: </span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="nx">@newAssessmentValid</span>
      <span class="nv">newAssessment = </span><span class="k">new</span> <span class="nx">Assessment</span>
        <span class="s">&#39;name&#39;</span> <span class="o">:</span> <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.new_assessment_name&#39;</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;messages&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="s">&quot;&lt;span class=&#39;error&#39;&gt;Error saving changes &lt;img src=&#39;images/icon_close.png&#39; class=&#39;clear_message&#39;&gt;&lt;/span&gt;&quot;</span>


  <span class="nx">initialize</span><span class="o">:</span><span class="nf">(options) -&gt;</span>
    <span class="vi">@isAdmin = </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">isAdmin</span>

    <span class="nx">@initializeSubmenu</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">options</span><span class="p">.</span><span class="nx">submenu</span> <span class="o">==</span> <span class="kc">false</span>

    <span class="vi">@views = </span><span class="p">[]</span>
    <span class="vi">@collection = </span><span class="k">new</span> <span class="nx">AssessmentCollection</span> <span class="kc">null</span><span class="p">,</span>
      <span class="nv">group : </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">group</span>
      <span class="nv">comparator : </span><span class="nf">(a, b) -&gt;</span>
        <span class="k">if</span> <span class="nx">a</span><span class="p">.</span><span class="nx">name</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">name</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="nx">@collection</span><span class="p">.</span><span class="kc">on</span> <span class="s">&quot;change&quot;</span><span class="p">,</span> <span class="nx">@render</span>
    <span class="nx">@collection</span><span class="p">.</span><span class="nx">fetch</span>
    </pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>One view to rule them all
Not necessary to be a view but just in case we need it to do more</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">ViewManager</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>
  <span class="nv">show: </span><span class="nf">(view) -&gt;</span>
    <span class="nx">@currentView</span><span class="o">?</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
    <span class="vi">@currentView = </span><span class="nx">view</span>
    <span class="nx">@currentView</span><span class="p">.</span><span class="kc">on</span> <span class="s">&quot;rendered&quot;</span><span class="p">,</span> <span class="o">=&gt;</span> 
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">@currentView</span><span class="p">.</span><span class="nx">el</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>one for the money</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">@currentView</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;rendered&quot;</span>


<span class="nv">vm = </span><span class="k">new</span> <span class="nx">ViewManager</span>

<span class="k">class</span> <span class="nx">AssessmentElement</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>

  <span class="nv">tagName : </span><span class="s">&quot;li&quot;</span>

  <span class="nv">events:</span>
    <span class="s">&#39;click .link_icon&#39;</span> <span class="o">:</span> <span class="s">&#39;navigate&#39;</span>
    <span class="s">&#39;click .assessment_menu_toggle&#39;</span> <span class="o">:</span> <span class="s">&#39;assessmentMenuToggle&#39;</span>

  <span class="nx">initialize</span><span class="o">:</span><span class="nf">(options) -&gt;</span>
    <span class="vi">@isAdmin = </span><span class="nx">options</span><span class="p">.</span><span class="nx">isAdmin</span>
    <span class="vi">@model = </span><span class="nx">options</span><span class="p">.</span><span class="nx">model</span>

  <span class="nv">navigate: </span><span class="nf">(event) -&gt;</span>
    <span class="nv">whereTo = </span><span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&#39;data-href&#39;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span> <span class="nx">whereTo</span><span class="p">,</span> <span class="kc">true</span>

  <span class="nv">assessmentMenuToggle: </span><span class="o">-&gt;</span>
    <span class="nv">toggleChar = </span><span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span> <span class="s">&#39;.assessment_menu_toggle&#39;</span>
    <span class="k">if</span> <span class="nx">toggleChar</span><span class="p">.</span><span class="nx">html</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;&amp;gt; &#39;</span> <span class="k">then</span> <span class="nx">toggleChar</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s">&#39;&amp;nabla; &#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nx">toggleChar</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s">&quot;&amp;gt; &quot;</span><span class="p">)</span> 
    <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.assessment_menu&#39;</span><span class="p">).</span><span class="nx">toggle</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>

  <span class="nv">render: </span><span class="o">-&gt;</span>
    <span class="nv">deleteButton  = </span><span class="s">&quot;&lt;img data-href=&#39;delete&#39; class=&#39;link_icon&#39; src=&#39;images/icon_delete.png&#39;&gt;&quot;</span>
    <span class="nv">editButton    = </span><span class="s">&quot;&lt;img data-href=&#39;edit/&#39; class=&#39;link_icon&#39; src=&#39;images/icon_edit.png&#39;&gt;&quot;</span>
    <span class="nv">resultsButton = </span><span class="s">&quot;&lt;img data-href=&#39;results&#39; class=&#39;link_icon&#39; src=&#39;images/icon_result.png&#39;&gt;&quot;</span>
    <span class="nv">runButton     = </span><span class="s">&quot;&lt;img data-href=&#39;run&#39; class=&#39;link_icon&#39; src=&#39;images/icon_run.png&#39;&gt;&quot;</span>
    <span class="nv">name          = </span><span class="s">&quot;&lt;span class=&#39;name&#39;&gt;</span><span class="si">#{</span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span><span class="si">}</span><span class="s">&lt;/span&gt;&quot;</span>
    <span class="nv">resultCount   = </span><span class="s">&quot;&lt;span class=&#39;resultCount&#39;&gt;</span><span class="si">#{</span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;resultCount&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="s">&#39;0&#39;</span><span class="si">}</span><span class="s"> results&lt;/span&gt;&quot;</span>
    <span class="nv">subtestCount  = </span><span class="nx">@model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;urlPathsForPages&#39;</span><span class="p">).</span><span class="nx">length</span>

    <span class="k">if</span> <span class="nx">@isAdmin</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">html</span> <span class="s">&quot;</span>
<span class="s">        &lt;div&gt;</span>
<span class="s">          &lt;span class=&#39;assessment_menu_toggle clickable&#39;&gt;&amp;gt; &lt;/span&gt;</span>
<span class="s">            </span><span class="si">#{</span><span class="nx">name</span><span class="si">}</span><span class="s"> </span>
<span class="s">            </span><span class="si">#{</span><span class="nx">resultCount</span><span class="si">}</span><span class="s"></span>
<span class="s">        &lt;/div&gt;</span>
<span class="s">        &lt;div class=&#39;assessment_menu&#39;&gt;</span>
<span class="s">          </span><span class="si">#{</span><span class="nx">runButton</span><span class="si">}</span><span class="s"></span>
<span class="s">          </span><span class="si">#{</span><span class="nx">resultsButton</span><span class="si">}</span><span class="s"></span>
<span class="s">          </span><span class="si">#{</span><span class="nx">editButton</span><span class="si">}</span><span class="s"></span>
<span class="s">          </span><span class="si">#{</span><span class="nx">deleteButton</span><span class="si">}</span><span class="s"></span>
<span class="s">        &lt;/div&gt;&quot;</span>
    <span class="k">else</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">html</span> <span class="s">&quot;&lt;div&gt;</span><span class="si">#{</span><span class="nx">runButton</span><span class="si">}#{</span><span class="nx">name</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">resultsButton</span><span class="si">}#{</span><span class="nx">resultCount</span><span class="si">}</span><span class="s">&lt;/div&gt;&quot;</span>


<span class="k">class</span> <span class="nx">AssessmentList</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>

  <span class="nv">tagName   : </span><span class="s">&quot;ul&quot;</span>

  <span class="nv">className : </span><span class="s">&quot;assessmentList&quot;</span>

  <span class="nv">events:</span>
    <span class="s">&#39;submit form&#39;</span>                  <span class="o">:</span> <span class="s">&#39;newAssessmentSave&#39;</span>
    <span class="s">&#39;click .new_assessment_save&#39;</span>   <span class="o">:</span> <span class="s">&#39;newAssessmentSave&#39;</span>
    <span class="s">&#39;click .new_assessment_cancel&#39;</span> <span class="o">:</span> <span class="s">&#39;newAssessmentHide&#39;</span>
    <span class="s">&#39;click .add_assessment&#39;</span>        <span class="o">:</span> <span class="s">&#39;newAssessmentShow&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Making a new assessment</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">newAssessmentShow: </span> <span class="o">-&gt;</span> <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.new_assessment_form&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>
  <span class="nv">newAssessmentHide: </span> <span class="o">-&gt;</span> <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.new_assessment_form&#39;</span><span class="p">).</span><span class="nx">fadeOut</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>
  <span class="nv">newAssessmentValid: </span><span class="o">-&gt;</span> <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.new_assessment_name&#39;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span>
  <span class="nv">newAssessmentSave: </span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="nx">@newAssessmentValid</span>
      <span class="nv">newAssessment = </span><span class="k">new</span> <span class="nx">Assessment</span>
        <span class="s">&#39;name&#39;</span> <span class="o">:</span> <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;.new_assessment_name&#39;</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;messages&#39;</span><span class="p">).</span><span class="nx">append</span> <span class="s">&quot;&lt;span class=&#39;error&#39;&gt;Error saving changes &lt;img src=&#39;images/icon_close.png&#39; class=&#39;clear_message&#39;&gt;&lt;/span&gt;&quot;</span>


  <span class="nx">initialize</span><span class="o">:</span><span class="nf">(options) -&gt;</span>
    <span class="vi">@isAdmin = </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">isAdmin</span>

    <span class="nx">@initializeSubmenu</span><span class="p">()</span> <span class="nx">unless</span> <span class="nx">options</span><span class="p">.</span><span class="nx">submenu</span> <span class="o">==</span> <span class="kc">false</span>

    <span class="vi">@views = </span><span class="p">[]</span>
    <span class="vi">@collection = </span><span class="k">new</span> <span class="nx">AssessmentCollection</span> <span class="kc">null</span><span class="p">,</span>
      <span class="nv">group : </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">group</span>
      <span class="nv">comparator : </span><span class="nf">(a, b) -&gt;</span>
        <span class="k">if</span> <span class="nx">a</span><span class="p">.</span><span class="nx">name</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">name</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="nx">@collection</span><span class="p">.</span><span class="kc">on</span> <span class="s">&quot;change&quot;</span><span class="p">,</span> <span class="nx">@render</span>
    <span class="nx">@collection</span><span class="p">.</span><span class="nx">fetch</span>
      <span class="nv">success: </span><span class="o">=&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>maybe this isn't the best place for a filter
only applies to this list</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">@collection</span><span class="p">.</span><span class="nx">filter</span> <span class="nf">(a, b, c) -&gt;</span> <span class="k">return</span> <span class="o">-&gt;</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>; if ! assessment.get('group') || assessment.get('group') == @collection.group then true else false</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">@collection</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;change&quot;</span>

  <span class="nv">initializeSubmenu: </span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="nx">@isAdmin</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;nav</span><span class="err">#</span><span class="s">main_nav&quot;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&quot;&lt;button data-submenu=&#39;new&#39;&gt;new&lt;/button&gt;&quot;</span>

  <span class="nv">submenuHandler: </span><span class="nf">(event) -&gt;</span>
    <span class="nv">submenu = </span><span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&quot;data-submenu&quot;</span>
    <span class="k">if</span> <span class="nx">submenu</span> <span class="o">==</span> <span class="s">&quot;new&quot;</span>
      <span class="nx">@newAssessmentShow</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>maintain thisness</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">render: </span><span class="o">=&gt;</span>
    <span class="nx">@closeViews</span><span class="p">()</span>
    <span class="vi">@views = </span><span class="p">[]</span>

    <span class="nx">@$el</span><span class="p">.</span><span class="nx">html</span> <span class="s">&quot;</span>
<span class="s">      &lt;form class=&#39;new_assessment_form&#39;&gt;</span>
<span class="s">        &lt;input type=&#39;text&#39; class=&#39;new_assessment_name&#39; placeholder=&#39;Assessment Name&#39;&gt;</span>
<span class="s">        &lt;button class=&#39;new_assessment_save&#39;&gt;Save&lt;/button&gt;</span>
<span class="s">        &lt;button class=&#39;new_assessment_cancel&#39;&gt;Cancel&lt;/button&gt;</span>
<span class="s">      &lt;/form&gt;&quot;</span>

    <span class="k">for</span> <span class="nx">assessment</span> <span class="k">in</span> <span class="nx">@collection</span><span class="p">.</span><span class="nx">models</span>
      <span class="nv">lastView = </span><span class="k">new</span> <span class="nx">AssessmentElement</span>
        <span class="nv">model : </span><span class="nx">assessment</span>
        <span class="nv">isAdmin : </span><span class="nx">@isAdmin</span>
      <span class="nx">@views</span><span class="p">.</span><span class="nx">push</span> <span class="nx">lastView</span>
      <span class="nx">lastView</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">append</span> <span class="nx">lastView</span><span class="p">.</span><span class="nx">el</span>
    
    <span class="nx">@trigger</span> <span class="s">&quot;rendered&quot;</span>
  


  <span class="nv">closeViews: </span><span class="o">-&gt;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">@views</span><span class="p">,</span> <span class="nf">(view) -&gt;</span> <span class="nx">view</span><span class="p">.</span><span class="nx">close</span>
    
  <span class="nv">onClose: </span><span class="o">-&gt;</span>
    <span class="nx">@closeViews</span><span class="p">()</span>

<span class="k">class</span> <span class="nx">DashboardView</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>

  <span class="nv">initialize: </span><span class="o">-&gt;</span>
    <span class="vi">@assessments = </span><span class="k">new</span> <span class="nx">AssessmentList</span> 
      <span class="nv">isAdmin : </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">isAdmin</span>
      <span class="nv">submenu : </span><span class="kc">false</span>
    <span class="nx">@assessments</span><span class="p">.</span><span class="nx">setElement</span> <span class="s">&quot;</span><span class="err">#</span><span class="s">dash_assessments&quot;</span>
        
    <span class="nx">@render</span><span class="p">()</span>

  <span class="nv">render: </span><span class="o">-&gt;</span>
    <span class="nx">@$el</span><span class="p">.</span><span class="nx">html</span> <span class="s">&quot;</span>
<span class="s">      &lt;h1&gt;dashboard&lt;/h1&gt;</span>
<span class="s">      &lt;div id=&#39;dash_assessments&#39;&gt;&lt;/div&gt;</span>
<span class="s">      &lt;div id=&#39;dash_user&#39;&gt;&lt;/div&gt;</span>
<span class="s">      &lt;div id=&#39;dash_group&#39;&gt;&lt;/div&gt;</span>
<span class="s">      &quot;</span>
    
    <span class="nx">@assessments</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
    
    <span class="nx">@trigger</span> <span class="s">&quot;rendered&quot;</span> 

<span class="k">class</span> <span class="nx">Router</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Router</span>
  <span class="nv">routes:</span>
    <span class="s">&#39;login&#39;</span>  <span class="o">:</span> <span class="s">&#39;login&#39;</span>
    <span class="s">&#39;logout&#39;</span> <span class="o">:</span> <span class="s">&#39;logout&#39;</span>
    
    <span class="s">&#39;&#39;</span>          <span class="o">:</span> <span class="s">&#39;dashboard&#39;</span>
    <span class="s">&#39;dashboard&#39;</span> <span class="o">:</span> <span class="s">&#39;dashboard&#39;</span>

    <span class="s">&#39;assessment/:name&#39;</span>         <span class="o">:</span> <span class="s">&#39;assessment&#39;</span>
    <span class="s">&#39;assessment/:name/run&#39;</span>     <span class="o">:</span> <span class="s">&#39;run&#39;</span>
    <span class="s">&#39;assessment/:name/edit&#39;</span>    <span class="o">:</span> <span class="s">&#39;edit&#39;</span>
    <span class="s">&#39;assessment/:name/results&#39;</span> <span class="o">:</span> <span class="s">&#39;results&#39;</span>

    <span class="s">&quot;assessments&quot;</span><span class="o">:</span> <span class="s">&quot;assessments&quot;</span>

    <span class="s">&quot;manage&quot;</span> <span class="o">:</span> <span class="s">&quot;manage&quot;</span>
    <span class="s">&quot;edit/assessment/:assessment_id&quot;</span><span class="o">:</span> <span class="s">&quot;editAssessment&quot;</span>
    <span class="s">&quot;edit/assessment/:assessment_id/subtest/:subtest_id&quot;</span><span class="o">:</span> <span class="s">&quot;editSubtest&quot;</span>
    <span class="s">&quot;results/tabular/:assessment_id&quot;</span><span class="o">:</span> <span class="s">&quot;tabular_results&quot;</span>
    <span class="s">&quot;results/tabular/:assessment_id/*options&quot;</span><span class="o">:</span> <span class="s">&quot;tabular_results&quot;</span>
    <span class="s">&quot;results/:assessmentId/:enumerator&quot;</span><span class="o">:</span> <span class="s">&quot;results&quot;</span>
    <span class="s">&quot;results/:assessmentId&quot;</span><span class="o">:</span> <span class="s">&quot;adminResults&quot;</span>

    <span class="s">&quot;print/:id&quot;</span><span class="o">:</span> <span class="s">&quot;print&quot;</span>
    <span class="s">&quot;student_printout/:id&quot;</span><span class="o">:</span> <span class="s">&quot;student_printout&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>"result/:id": "result"</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">dashboard: </span><span class="o">-&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span>
      <span class="nv">isAdmin: </span><span class="o">-&gt;</span>
        <span class="nv">dashboard = </span><span class="k">new</span> <span class="nx">DashboardView</span><span class="p">()</span>
        <span class="nx">vm</span><span class="p">.</span><span class="nx">show</span> <span class="nx">dashboard</span>
      <span class="nv">isUser: </span><span class="o">-&gt;</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span> <span class="s">&quot;assessments&quot;</span>

  <span class="nv">assessments: </span><span class="o">-&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span><span class="p">()</span>
    <span class="nv">assessments = </span><span class="k">new</span> <span class="nx">AssessmentList</span> 
    <span class="nx">vm</span><span class="p">.</span><span class="nx">show</span> <span class="nx">assessments</span>

  <span class="nv">editSubtest: </span><span class="nf">( assessment_id, subtest_id ) -&gt;</span>
    <span class="nv">assessment_id = </span><span class="nx">Utils</span><span class="p">.</span><span class="nx">cleanURL</span> <span class="nx">assessment_id</span>
    <span class="nv">subtest_id    = </span><span class="nx">Utils</span><span class="p">.</span><span class="nx">cleanURL</span> <span class="nx">subtest_id</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span>
      <span class="nv">isAdmin: </span><span class="o">-&gt;</span>
        <span class="nv">Tangerine.subtestEdit.assessment_id = </span><span class="nx">assessment_id</span>
        <span class="nv">Tangerine.subtestEdit.model = </span><span class="k">new</span> <span class="nx">Subtest</span>
          <span class="nv">_id: </span><span class="nx">subtest_id</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">subtestEdit</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">fetch</span> 
          <span class="nv">success: </span><span class="o">-&gt;</span>
            <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">subtestEdit</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>assessment = new Assessment
 <em>id: assessment</em>id
assessment.fetch
 success: -></p>             </td>             <td class="code">               <div class="highlight"><pre>            

  <span class="nv">editAssessment: </span><span class="nf">( assessment_id ) -&gt;</span>
    <span class="nv">assessment_id = </span><span class="nx">Utils</span><span class="p">.</span><span class="nx">cleanURL</span> <span class="nx">assessment_id</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span>
      <span class="nv">isAdmin: </span><span class="o">-&gt;</span>
        <span class="nv">assessment = </span><span class="k">new</span> <span class="nx">Assessment</span> <span class="p">{</span> <span class="nv">_id : </span><span class="nx">assessment_id</span> <span class="p">}</span>
        <span class="nx">assessment</span><span class="p">.</span><span class="nx">fetch</span>
          <span class="nv">success: </span><span class="nf">() -&gt;</span>
            <span class="nv">Tangerine.assessmentEditView.model = </span><span class="nx">assessment</span>
            <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">assessmentEditView</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>

  <span class="nv">results: </span><span class="nf">(assessmentId, enumerator) -&gt;</span>
    <span class="nv">assessmentId = </span><span class="nx">Utils</span><span class="p">.</span><span class="nx">cleanURL</span> <span class="nx">assessmentId</span>
    <span class="nv">enumerator   = </span><span class="nx">Utils</span><span class="p">.</span><span class="nx">cleanURL</span> <span class="nx">enumerator</span>

    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span>
      <span class="nv">isUser: </span><span class="o">-&gt;</span>
        <span class="nv">resultCollection = </span><span class="k">new</span> <span class="nx">ResultCollection</span><span class="p">()</span>
        <span class="nx">resultCollection</span><span class="p">.</span><span class="nx">fetch</span>
          <span class="nv">success: </span><span class="o">-&gt;</span>
            <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">resultsView</span> <span class="o">?=</span> <span class="k">new</span> <span class="nx">ResultsView</span><span class="p">()</span>
            <span class="nv">Tangerine.resultsView.assessment = </span><span class="k">new</span> <span class="nx">Assessment</span>
              <span class="nv">_id: </span> <span class="nx">assessmentId</span>
            <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">resultsView</span><span class="p">.</span><span class="nx">assessment</span><span class="p">.</span><span class="nx">fetch</span>
              <span class="nv">success: </span><span class="o">-&gt;</span>
                <span class="nv">Tangerine.resultsView.results = </span><span class="nx">resultCollection</span><span class="p">.</span><span class="nx">filter</span> <span class="nf">(result) -&gt;</span>
                  <span class="nx">result</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&quot;assessmentId&quot;</span><span class="p">)</span> <span class="o">is</span> <span class="nx">assessmentId</span> <span class="o">and</span> <span class="nx">result</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&quot;enumerator&quot;</span><span class="p">)</span> <span class="o">is</span> <span class="nx">enumerator</span>
                <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">resultsView</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>

  <span class="nv">adminResults: </span><span class="nf">(assessmentId) -&gt;</span>
    <span class="nv">assessmentId = </span><span class="nx">Utils</span><span class="p">.</span><span class="nx">cleanURL</span> <span class="nx">assessmentId</span>

    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span>
      <span class="nv">isAdmin: </span><span class="o">-&gt;</span>
        <span class="nv">resultCollection = </span><span class="k">new</span> <span class="nx">ResultCollection</span><span class="p">()</span>
        <span class="nx">resultCollection</span><span class="p">.</span><span class="nx">fetch</span>
          <span class="nv">success: </span><span class="o">-&gt;</span>
            <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">resultsView</span> <span class="o">?=</span> <span class="k">new</span> <span class="nx">ResultsView</span><span class="p">()</span>
            <span class="nv">Tangerine.resultsView.assessment = </span><span class="k">new</span> <span class="nx">Assessment</span>
              <span class="nv">_id: </span> <span class="nx">Utils</span><span class="p">.</span><span class="nx">cleanURL</span> <span class="nx">assessmentId</span>
            <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">resultsView</span><span class="p">.</span><span class="nx">assessment</span><span class="p">.</span><span class="nx">fetch</span>
              <span class="nv">success: </span><span class="o">-&gt;</span>
                <span class="nv">Tangerine.resultsView.isAdmin = </span><span class="kc">true</span>
                <span class="nv">Tangerine.resultsView.results = </span><span class="nx">resultCollection</span><span class="p">.</span><span class="nx">filter</span> <span class="nf">(result) -&gt;</span>
                  <span class="nx">result</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&quot;assessmentId&quot;</span><span class="p">)</span> <span class="o">is</span> <span class="nx">assessmentId</span>
                <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">resultsView</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>

  <span class="nv">tabular_results: </span><span class="nf">(assessmentId) -&gt;</span>
    <span class="nv">assessmentId = </span><span class="nx">Utils</span><span class="p">.</span><span class="nx">cleanURL</span> <span class="nx">assessmentId</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span> 
      <span class="nv">isUser: </span><span class="o">-&gt;</span>
        <span class="nv">Tangerine.csvView = </span><span class="k">new</span> <span class="nx">CSVView</span> 
          <span class="nv">assessmentId : </span><span class="nx">assessmentId</span>
    

  <span class="nv">result: </span><span class="nf">(id) -&gt;</span>
    <span class="nx">@verify_logged_in</span>
      <span class="nv">success: </span><span class="o">-&gt;</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">resultView</span> <span class="o">?=</span> <span class="k">new</span> <span class="nx">ResultView</span><span class="p">()</span>
        <span class="nv">Tangerine.resultView.model = </span><span class="k">new</span> <span class="nx">Result</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">resultView</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">fetch</span>
          <span class="nx">success</span><span class="o">:-&gt;</span>
            <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="nx">html</span> <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">resultView</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>

  <span class="nv">manage: </span><span class="o">-&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span>
      <span class="nv">isAdmin: </span><span class="o">-&gt;</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">assessmentCollection</span><span class="p">.</span><span class="nx">fetch</span>
          <span class="nv">success: </span><span class="o">-&gt;</span>
            <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">manageView</span><span class="p">.</span><span class="nx">render</span> <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">assessmentCollection</span>

  <span class="nv">zzassessments : </span><span class="o">-&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span>
      <span class="nv">isUser: </span><span class="o">-&gt;</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">assessmentListView</span> <span class="o">?=</span> <span class="k">new</span> <span class="nx">AssessmentListView</span><span class="p">()</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">assessmentListView</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
      <span class="nv">unregistered: </span><span class="o">-&gt;</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span> <span class="s">&quot;login&quot;</span><span class="p">,</span> <span class="kc">true</span>

  <span class="nv">login: </span><span class="o">-&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">loginView</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>

  <span class="nv">logout: </span><span class="o">-&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">logout</span><span class="p">()</span>

  <span class="nv">assessment: </span><span class="nf">(id) -&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span>
      <span class="nv">isUser: </span><span class="o">-&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>This is terrible but it fixes my problem
Currently live click handlers get duplicated over and over again
Need to convert everything to backbone style views
Not only backbone style views, but reuse views and destroy them</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">assessment</span><span class="o">?</span> <span class="o">||</span> <span class="nx">$</span><span class="p">.</span><span class="nx">assessment</span><span class="o">?</span>
          <span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">()</span>

        <span class="nv">Tangerine.assessment = </span><span class="k">new</span> <span class="nx">Assessment</span> <span class="p">{</span> <span class="nv">_id : </span><span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">}</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">assessment</span><span class="p">.</span><span class="nx">fetch</span>
          <span class="nv">success: </span><span class="o">-&gt;</span>
            <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">assessment</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>

  <span class="nv">verify_logged_in: </span><span class="nf">(options) -&gt;</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">couch</span><span class="p">.</span><span class="nx">session</span>
      <span class="nv">success: </span><span class="p">(</span><span class="nx">session</span><span class="p">)</span> <span class="o">=&gt;</span>
        
        <span class="nv">Tangerine.enumerator = </span><span class="nx">session</span><span class="p">.</span><span class="nx">userCtx</span><span class="p">.</span><span class="nx">name</span>
        <span class="nv">Tangerine.userRoles = </span><span class="nx">_</span><span class="p">.</span><span class="nx">values</span> <span class="nx">session</span><span class="p">.</span><span class="nx">userCtx</span><span class="p">.</span><span class="nx">roles</span> 
        
        <span class="nv">Tangerine.router.targetroute = </span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span>
        
        <span class="nx">unless</span> <span class="nx">session</span><span class="p">.</span><span class="nx">userCtx</span><span class="p">.</span><span class="nx">name</span>
          <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span><span class="p">(</span><span class="s">&quot;login&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
          <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>@handle_menu session</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="nx">session</span>

  <span class="nv">print: </span><span class="nf">(id) -&gt;</span>
    <span class="nx">Assessment</span><span class="p">.</span><span class="nx">load</span> <span class="nx">id</span><span class="p">,</span> <span class="nf">(assessment) -&gt;</span>
      <span class="nx">assessment</span><span class="p">.</span><span class="nx">toPaper</span> <span class="nf">(result) -&gt;</span>
        <span class="nv">style = </span><span class="s">&quot;</span>
<span class="s">          body{</span>
<span class="s">            font-family: Arial;</span>
<span class="s">          }</span>
<span class="s">          .page-break{</span>
<span class="s">            display: block;</span>
<span class="s">            page-break-before: always;</span>
<span class="s">          }</span>
<span class="s">          input{</span>
<span class="s">            height: 50px;  </span>
<span class="s">            border: 1px</span>
<span class="s">          }</span>
<span class="s">        &quot;</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Remove the jquery mobile stylesheet</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;link&quot;</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>

  <span class="nv">student_printout: </span><span class="nf">(id) -&gt;</span>
    <span class="nx">Assessment</span><span class="p">.</span><span class="nx">load</span> <span class="nx">id</span><span class="p">,</span> <span class="nf">(assessment) -&gt;</span>
      <span class="nx">assessment</span><span class="p">.</span><span class="nx">toPaper</span> <span class="nf">(result) -&gt;</span>
        <span class="nv">style = </span><span class="s">&quot;</span>
<span class="s">          &lt;style&gt;</span>
<span class="s">            body{</span>
<span class="s">              font-family: Arial;</span>
<span class="s">              font-size: 200%;</span>
<span class="s">            }</span>
<span class="s">            .page-break{</span>
<span class="s">              display: none;</span>
<span class="s">            }</span>
<span class="s">            input{</span>
<span class="s">              height: 50px;  </span>
<span class="s">              border: 1px;</span>
<span class="s">            }</span>
<span class="s">            .subtest.ToggleGridWithTimer{</span>
<span class="s">              page-break-after: always;</span>
<span class="s">              display:block;</span>
<span class="s">              padding: 15px;</span>
<span class="s">            }</span>
<span class="s">            .subtest, button, h1{</span>
<span class="s">              display:none;</span>
<span class="s">            }</span>
<span class="s">            .grid{</span>
<span class="s">              display: inline;</span>
<span class="s">              margin: 5px;</span>
<span class="s">            }</span>
<span class="s">          &lt;/style&gt;</span>
<span class="s">        &quot;</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;style&quot;</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">result</span> <span class="o">+</span> <span class="nx">style</span><span class="p">)</span>
        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;span:contains(*)&quot;</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">remove</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Remove the jquery mobile stylesheet</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">$</span><span class="p">(</span><span class="s">&quot;link&quot;</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>

        <span class="nx">$</span><span class="p">(</span><span class="s">&#39;.grid&#39;</span><span class="p">).</span><span class="nx">each</span> <span class="nf">(index) -&gt;</span>
          <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">nextAll</span><span class="p">().</span><span class="nx">andSelf</span><span class="p">().</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">).</span><span class="nx">wrapAll</span><span class="p">(</span><span class="s">&#39;&lt;div class=&quot;grid-row&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">)</span> <span class="k">if</span><span class="p">(</span> <span class="nx">index</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Initialization/Detection</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">$</span> <span class="o">-&gt;</span> <span class="c1"># run after DOM loads</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Detect admin party mode
   $.couch.config(
     {
       success: (result) ->
         if <em>.keys(result).length == 0 # admin party mode
           $.couch.config({},"admins",Tangerine.config.user</em>with<em>database</em>create<em>permission, Tangerine.config.password</em>with<em>database</em>create_permission)
       error: ->
         # Do nothing - we can't access this because we are not admins
     }
     "admins"
   )</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Should remove later - always make sure the timeout is 28800 (8 hrs)
   $.ajax "/<em>config/couch</em>httpd<em>auth/timeout",
   username: Tangerine.config.user</em>with<em>database</em>create<em>permission
   password: Tangerine.config.password</em>with<em>database</em>create_permission
   type: "put"
   data: '"28800"'</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Start the application</p>             </td>             <td class="code">               <div class="highlight"><pre>  </pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Reuse the view objects to stop events from being duplicated (and to save memory)</p>             </td>             <td class="code">               <div class="highlight"><pre>  </pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Durables
Things here should be reused</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">Tangerine.router = </span><span class="k">new</span> <span class="nx">Router</span><span class="p">()</span>

  <span class="nv">Tangerine.assessmentCollection = </span><span class="k">new</span> <span class="nx">AssessmentCollection</span><span class="p">()</span>
  <span class="nv">Tangerine.manageView = </span><span class="k">new</span> <span class="nx">ManageView</span><span class="p">(</span> <span class="p">{</span> <span class="nv">collection : </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">assessmentCollection</span><span class="p">}</span> <span class="p">)</span>
  <span class="nv">Tangerine.assessmentEditView = </span><span class="k">new</span> <span class="nx">AssessmentEditView</span><span class="p">()</span>
  <span class="nv">Tangerine.subtestEdit = </span><span class="k">new</span> <span class="nx">SubtestEditView</span><span class="p">()</span>


  <span class="nv">Tangerine.user   = </span><span class="k">new</span> <span class="nx">User</span><span class="p">()</span>
  <span class="nv">Tangerine.loginView = </span><span class="k">new</span> <span class="nx">LoginView</span><span class="p">(</span> <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span> <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Tangerine.dispatch = _.clone Backbone.Events</p>             </td>             <td class="code">               <div class="highlight"><pre>  
  <span class="nv">Tangerine.nav = </span><span class="k">new</span> <span class="nx">Navigation</span>
    <span class="nv">user   : </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span>
    <span class="nv">router : </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">router</span>

  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Set up some interface stuff</p>             </td>             <td class="code">               <div class="highlight"><pre>  </pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <h3>.clear_message</h3>

<p>This little guy will fade out and clear him and his parents. Wrap him wisely.
<code>&lt;span&gt; my message &lt;button class="clear_message"&gt;X&lt;/button&gt;</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="kc">on</span><span class="p">(</span><span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="s">&quot;.clear_message&quot;</span><span class="p">,</span>  <span class="kc">null</span><span class="p">,</span> <span class="nf">(a) -&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">fadeOut</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">empty</span><span class="p">().</span><span class="nx">show</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>
  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="kc">on</span><span class="p">(</span><span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="s">&quot;.parent_remove&quot;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nf">(a) -&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">fadeOut</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>

  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.ajax_loading&quot;</span><span class="p">).</span><span class="nx">ajaxStart</span> <span class="o">-&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">corner_logo&quot;</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="s">&quot;images/spin_orange.gif&quot;</span>
  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.ajax_loading&quot;</span><span class="p">).</span><span class="nx">ajaxStop</span> <span class="o">-&gt;</span>  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">corner_logo&quot;</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="s">&quot;images/corner_logo.png&quot;</span>

  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;click&quot;</span><span class="p">,</span><span class="s">&quot;.alert_button&quot;</span><span class="p">,</span> <span class="o">-&gt;</span>
    <span class="nv">alert_text = </span><span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;data-alert&quot;</span><span class="p">)</span> <span class="k">then</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;data-alert&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
    <span class="nx">Utils</span><span class="p">.</span><span class="nx">disposableAlert</span> <span class="nx">alert_text</span>

  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="s">&quot;.disposable_alert&quot;</span><span class="p">,</span> <span class="o">-&gt;</span> 
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">stop</span><span class="p">().</span><span class="nx">fadeOut</span> <span class="mi">250</span><span class="p">,</span> <span class="o">-&gt;</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>


      <span class="nv">success: </span><span class="o">=&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>maybe this isn't the best place for a filter
only applies to this list</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">@collection</span><span class="p">.</span><span class="nx">filter</span> <span class="nf">(a, b, c) -&gt;</span> <span class="k">return</span> <span class="o">-&gt;</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>; if ! assessment.get('group') || assessment.get('group') == @collection.group then true else false</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">@collection</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;change&quot;</span>

  <span class="nv">initializeSubmenu: </span><span class="o">-&gt;</span>
    <span class="k">if</span> <span class="nx">@isAdmin</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;nav</span><span class="err">#</span><span class="s">main_nav&quot;</span><span class="p">).</span><span class="nx">html</span> <span class="s">&quot;&lt;button data-submenu=&#39;new&#39;&gt;new&lt;/button&gt;&quot;</span>

  <span class="nv">submenuHandler: </span><span class="nf">(event) -&gt;</span>
    <span class="nv">submenu = </span><span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&quot;data-submenu&quot;</span>
    <span class="k">if</span> <span class="nx">submenu</span> <span class="o">==</span> <span class="s">&quot;new&quot;</span>
      <span class="nx">@newAssessmentShow</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>maintain thisness</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">render: </span><span class="o">=&gt;</span>
    <span class="nx">@closeViews</span><span class="p">()</span>
    <span class="vi">@views = </span><span class="p">[]</span>

    <span class="nx">@$el</span><span class="p">.</span><span class="nx">html</span> <span class="s">&quot;</span>
<span class="s">      &lt;form class=&#39;new_assessment_form&#39;&gt;</span>
<span class="s">        &lt;input type=&#39;text&#39; class=&#39;new_assessment_name&#39; placeholder=&#39;Assessment Name&#39;&gt;</span>
<span class="s">        &lt;button class=&#39;new_assessment_save&#39;&gt;Save&lt;/button&gt;</span>
<span class="s">        &lt;button class=&#39;new_assessment_cancel&#39;&gt;Cancel&lt;/button&gt;</span>
<span class="s">      &lt;/form&gt;&quot;</span>

    <span class="k">for</span> <span class="nx">assessment</span> <span class="k">in</span> <span class="nx">@collection</span><span class="p">.</span><span class="nx">models</span>
      <span class="nv">lastView = </span><span class="k">new</span> <span class="nx">AssessmentElement</span>
        <span class="nv">model : </span><span class="nx">assessment</span>
        <span class="nv">isAdmin : </span><span class="nx">@isAdmin</span>
      <span class="nx">@views</span><span class="p">.</span><span class="nx">push</span> <span class="nx">lastView</span>
      <span class="nx">lastView</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
      <span class="nx">@$el</span><span class="p">.</span><span class="nx">append</span> <span class="nx">lastView</span><span class="p">.</span><span class="nx">el</span>
    
    <span class="nx">@trigger</span> <span class="s">&quot;rendered&quot;</span>
  


  <span class="nv">closeViews: </span><span class="o">-&gt;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="nx">@views</span><span class="p">,</span> <span class="nf">(view) -&gt;</span> <span class="nx">view</span><span class="p">.</span><span class="nx">close</span>
    
  <span class="nv">onClose: </span><span class="o">-&gt;</span>
    <span class="nx">@closeViews</span><span class="p">()</span>

<span class="k">class</span> <span class="nx">DashboardView</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>

  <span class="nv">initialize: </span><span class="o">-&gt;</span>
    <span class="vi">@assessments = </span><span class="k">new</span> <span class="nx">AssessmentList</span> 
      <span class="nv">isAdmin : </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">isAdmin</span>
      <span class="nv">submenu : </span><span class="kc">false</span>
        
    <span class="nx">@render</span><span class="p">()</span>

  <span class="nv">render: </span><span class="o">-&gt;</span>
    <span class="nx">@$el</span><span class="p">.</span><span class="nx">html</span> <span class="s">&quot;</span>
<span class="s">      &lt;h1&gt;dashboard&lt;/h1&gt;</span>
<span class="s">      &lt;div id=&#39;dash_assessments&#39;&gt;&lt;/div&gt;</span>
<span class="s">      &lt;div id=&#39;dash_user&#39;&gt;&lt;/div&gt;</span>
<span class="s">      &lt;div id=&#39;dash_group&#39;&gt;&lt;/div&gt;</span>
<span class="s">      &quot;</span>
    
    <span class="nx">@trigger</span> <span class="s">&quot;rendered&quot;</span> 

<span class="k">class</span> <span class="nx">Router</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Router</span>
  <span class="nv">routes:</span>
    <span class="s">&#39;login&#39;</span>  <span class="o">:</span> <span class="s">&#39;login&#39;</span>
    <span class="s">&#39;logout&#39;</span> <span class="o">:</span> <span class="s">&#39;logout&#39;</span>
    
    <span class="s">&#39;&#39;</span>          <span class="o">:</span> <span class="s">&#39;dashboard&#39;</span>
    <span class="s">&#39;dashboard&#39;</span> <span class="o">:</span> <span class="s">&#39;dashboard&#39;</span>

    <span class="s">&#39;assessment/:name&#39;</span>         <span class="o">:</span> <span class="s">&#39;assessment&#39;</span>
    <span class="s">&#39;assessment/:name/run&#39;</span>     <span class="o">:</span> <span class="s">&#39;run&#39;</span>
    <span class="s">&#39;assessment/:name/edit&#39;</span>    <span class="o">:</span> <span class="s">&#39;edit&#39;</span>
    <span class="s">&#39;assessment/:name/results&#39;</span> <span class="o">:</span> <span class="s">&#39;results&#39;</span>

    <span class="s">&quot;assessments&quot;</span><span class="o">:</span> <span class="s">&quot;assessments&quot;</span>


  <span class="nv">dashboard: </span><span class="o">-&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span>
      <span class="nv">isAdmin: </span><span class="o">-&gt;</span>
        <span class="nv">dashboard = </span><span class="k">new</span> <span class="nx">DashboardView</span>
        <span class="nx">vm</span><span class="p">.</span><span class="nx">show</span> <span class="nx">dashboard</span>
      <span class="nv">isUser: </span><span class="o">-&gt;</span>
        <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span> <span class="s">&quot;assessments&quot;</span>

  <span class="nv">assessments: </span><span class="o">-&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">verify</span><span class="p">()</span>
    <span class="nv">assessments = </span><span class="k">new</span> <span class="nx">AssessmentList</span> 
    <span class="nx">vm</span><span class="p">.</span><span class="nx">show</span> <span class="nx">assessments</span>

  <span class="nv">login: </span><span class="o">-&gt;</span>
    <span class="nv">loginView = </span><span class="nx">LoginView</span><span class="p">()</span>
    <span class="nx">vm</span><span class="p">.</span><span class="nx">show</span> <span class="nx">loginView</span>

  <span class="nv">logout: </span><span class="o">-&gt;</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">logout</span><span class="p">()</span>
    <span class="nx">Tangerine</span><span class="p">.</span><span class="nx">router</span><span class="p">.</span><span class="nx">navigate</span> <span class="s">&quot;login&quot;</span><span class="p">,</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Initialization/Detection</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">$</span> <span class="o">-&gt;</span> <span class="c1"># run after DOM loads</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Start the application</p>             </td>             <td class="code">               <div class="highlight"><pre>  </pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Reuse the view objects to stop events from being duplicated (and to save memory)</p>             </td>             <td class="code">               <div class="highlight"><pre>  </pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Durables
Things here should be reused</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">Tangerine.router = </span><span class="k">new</span> <span class="nx">Router</span><span class="p">()</span>
  <span class="nv">Tangerine.user   = </span><span class="k">new</span> <span class="nx">User</span><span class="p">()</span>
  <span class="nv">Tangerine.nav = </span><span class="k">new</span> <span class="nx">Navigation</span>
    <span class="nv">user   : </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">user</span>
    <span class="nv">router : </span><span class="nx">Tangerine</span><span class="p">.</span><span class="nx">router</span>

  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Set up some interface stuff</p>             </td>             <td class="code">               <div class="highlight"><pre>  </pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <h3>.clear_message</h3>

<p>This little guy will fade out and clear him and his parents. Wrap him wisely.
<code>&lt;span&gt; my message &lt;button class="clear_message"&gt;X&lt;/button&gt;</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="kc">on</span><span class="p">(</span><span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="s">&quot;.clear_message&quot;</span><span class="p">,</span>  <span class="kc">null</span><span class="p">,</span> <span class="nf">(a) -&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">fadeOut</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">empty</span><span class="p">().</span><span class="nx">show</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>
  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="kc">on</span><span class="p">(</span><span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="s">&quot;.parent_remove&quot;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nf">(a) -&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">fadeOut</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Spin the logo on ajax calls</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.ajax_loading&quot;</span><span class="p">).</span><span class="nx">ajaxStart</span> <span class="o">-&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">corner_logo&quot;</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="s">&quot;images/spin_orange.gif&quot;</span>
  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;.ajax_loading&quot;</span><span class="p">).</span><span class="nx">ajaxStop</span> <span class="o">-&gt;</span>  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">corner_logo&quot;</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="s">&quot;images/corner_logo.png&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>disposable alerts, this should be moved</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;click&quot;</span><span class="p">,</span><span class="s">&quot;.alert_button&quot;</span><span class="p">,</span> <span class="o">-&gt;</span>
    <span class="nv">alert_text = </span><span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;data-alert&quot;</span><span class="p">)</span> <span class="k">then</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;data-alert&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
    <span class="nx">Utils</span><span class="p">.</span><span class="nx">disposableAlert</span> <span class="nx">alert_text</span>

  <span class="nx">$</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">content&quot;</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="s">&quot;.disposable_alert&quot;</span><span class="p">,</span> <span class="o">-&gt;</span> 
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">stop</span><span class="p">().</span><span class="nx">fadeOut</span> <span class="mi">250</span><span class="p">,</span> <span class="o">-&gt;</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">remove</span><span class="p">()</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 